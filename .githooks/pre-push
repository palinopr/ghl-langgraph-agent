#!/bin/bash
# Pre-push hook to validate workflow before pushing to remote
# This prevents deployment failures that waste 15 minutes

echo "üîç Running pre-push validation..."

# Activate virtual environment if it exists
if [ -d "venv313" ]; then
    source venv313/bin/activate
elif [ -d "venv" ]; then
    source venv/bin/activate
fi

# Run validation
python validate_workflow.py

# Check exit code
if [ $? -ne 0 ]; then
    echo ""
    echo "‚ùå Pre-push validation FAILED!"
    echo "‚ùå Push cancelled to prevent deployment failure."
    echo ""
    echo "Fix the errors above and try again."
    exit 1
fi

echo ""
echo "‚úÖ Pre-push validation passed!"
echo "‚úÖ Proceeding with push..."
echo ""